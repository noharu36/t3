# t3

このプロジェクトは、Rustで作成されたシンプルなオブジェクトストレージです。基本的なファイルのアップロード（POST）、ダウンロード（GET）、削除（DELETE）機能を提供します。
名称はrusT objecT sTrageの略称です（こじつけ）

## 機能

* **POST:** multipart形式でファイルをアップロードし、一意のオブジェクトIDを返します。データはReed-Solomon符号を用いて分割・エンコードされ、複数のストレージに分散して保存されます。
* **GET:** オブジェクトIDと元のファイル名を指定することで、保存されたファイルを復元し、ダウンロードできます。元のファイル名からMIMEタイプを予測してレスポンスヘッダーに含めます。
* **DELETE:** オブジェクトIDを指定することで、関連するデータをストレージから削除します。削除の成否がレスポンスとして返されます。
* **ログトレース:** `tracing` クレートによるログ出力で、サーバーの動作を追跡できます。


## 使い方 (開発環境)

1.  **クローン:** このリポジトリをクローンしてください。
2.  **ビルド:** `cargo build` コマンドでプロジェクトをビルドします。
3.  **実行:** `cargo run` コマンドでサーバーを起動します。デフォルトでは `127.0.0.1:8080` でリッスンします。(localhostではなぜかアクセスできません...)

## API

* **POST**: ファイルのアップロード (multipart/form-data)
```
curlでの例
curl -v -X POST http://127.0.0.1:8080/object -F "file=@filepath"
```
* **GET**: ファイルのダウンロード
```
curlでの例
curl -v -X GET \
  http://127.0.0.1:8080/object \
  -H "content-type: application/json" \
  --data '{
  "object_id": "POSTのレスポンスに含まれるobject_id",
  "file_name": "元ファイル名"
  }' \
--output "保存する時のファイル名"
```
* **DELETE**: ファイルの削除
```
curlでの例
curl -v -X DELETE \
  http://127.0.0.1:8080/object \
  -H "content-type: application/json" \
  --data '{
  "object_id": "POSTのレスポンスに含まれるobject_id"
}'
```

**※cURLでPOSTリクエストを送信した時、拡張子からContent-Typeを判断できない場合にエラーが出る可能性があります。PostmanやBrunoなどのAPIクライアントを使うとエラーを解消できる場合があります。**

## 今後の開発予定

- [ ] メタデータの導入
- [ ] バケットの概念の導入
- [ ] より高度なスケーラビリティと可用性の実現
- [ ] 認証・認可機能の追加
- [ ] オブジェクトライフサイクル管理
- [ ] バージョン管理
- [ ] S3互換APIの検討

## 注意事項

これはシンプルなオブジェクトストレージのデモンストレーションであり、プロダクション環境での利用を想定したものではありません。セキュリティや耐久性など、多くの点で改善の余地があります。
